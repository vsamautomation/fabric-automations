{
    "workspaces": [
        {
            "id": "32bcf9c2-9d7d-4857-9188-ef29efac3a3b",
            "name": "Test Workspace",
            "description": "Test",
            "type": "Workspace",
            "state": "Active",
            "isOnDedicatedCapacity": true,
            "capacityId": "5617B66C-C9DB-4C90-A8FD-A556F83FB3FD",
            "defaultDatasetStorageFormat": "Small",
            "Notebook": [
                {
                    "id": "c08f17e5-d4da-4004-983e-56fc58b6a148",
                    "name": "Notebook 1",
                    "description": "New notebook",
                    "state": "Active",
                    "lastUpdatedDate": "2025-10-06T14:16:04.5010627",
                    "createdDate": "2025-10-06T13:30:27.5713167",
                    "modifiedBy": "victorsam@vsamautomation.com",
                    "createdBy": "victorsam@vsamautomation.com",
                    "modifiedById": "7afce4a6-37a7-4db8-962e-9b8d4e2bc885",
                    "createdById": "7afce4a6-37a7-4db8-962e-9b8d4e2bc885",
                    "extendedProperties": {},
                    "tags": []
                }
            ],
            "reports": [
                {
                    "reportType": "PowerBIReport",
                    "id": "eb221b13-e89e-4ff9-a7d1-9873ea0c410d",
                    "name": "New Waziri Dashboard Report",
                    "datasetId": "b65c4f2f-2716-4744-8640-02768f9bb745",
                    "createdDateTime": "2025-08-29T08:28:01.387",
                    "modifiedDateTime": "2025-08-29T08:28:01.387",
                    "modifiedBy": "victorsam@vsamautomation.com",
                    "createdBy": "victorsam@vsamautomation.com",
                    "modifiedById": "7afce4a6-37a7-4db8-962e-9b8d4e2bc885",
                    "createdById": "7afce4a6-37a7-4db8-962e-9b8d4e2bc885",
                    "tags": []
                },
                {
                    "reportType": "PowerBIReport",
                    "id": "a9b83304-aed6-4124-aa46-90c8cdc71bdd",
                    "name": "Report Usage Metrics Report",
                    "datasetId": "cc7bc30b-a5bb-4a17-bfa9-9675940f2468",
                    "createdDateTime": "2025-10-06T11:33:06.82",
                    "modifiedDateTime": "2025-10-06T11:33:06.82",
                    "modifiedBy": "victorsam@vsamautomation.com",
                    "createdBy": "victorsam@vsamautomation.com",
                    "modifiedById": "7afce4a6-37a7-4db8-962e-9b8d4e2bc885",
                    "createdById": "7afce4a6-37a7-4db8-962e-9b8d4e2bc885",
                    "tags": []
                }
            ],
            "dashboards": [],
            "datasets": [
                {
                    "id": "b65c4f2f-2716-4744-8640-02768f9bb745",
                    "name": "New Waziri Dashboard Report",
                    "tables": [
                        {
                            "name": "Calendar",
                            "isHidden": false,
                            "storageMode": "Import",
                            "columns": [
                                {
                                    "name": "Date",
                                    "dataType": "DateTime",
                                    "isHidden": false,
                                    "columnType": "Data"
                                },
                                {
                                    "name": "Year",
                                    "dataType": "Int64",
                                    "isHidden": false,
                                    "columnType": "Data"
                                },
                                {
                                    "name": "CurrYearOffset",
                                    "dataType": "Int64",
                                    "isHidden": false,
                                    "columnType": "Data"
                                },
                                {
                                    "name": "YearCompleted",
                                    "dataType": "Boolean",
                                    "isHidden": false,
                                    "columnType": "Data"
                                },
                                {
                                    "name": "Quarter Number",
                                    "dataType": "Int64",
                                    "isHidden": false,
                                    "columnType": "Data"
                                },
                                {
                                    "name": "Quarter",
                                    "dataType": "String",
                                    "isHidden": false,
                                    "columnType": "Data"
                                },
                                {
                                    "name": "Start of Quarter",
                                    "dataType": "DateTime",
                                    "isHidden": false,
                                    "columnType": "Data"
                                },
                                {
                                    "name": "End of Quarter",
                                    "dataType": "DateTime",
                                    "isHidden": false,
                                    "columnType": "Data"
                                },
                                {
                                    "name": "Quarter & Year",
                                    "dataType": "String",
                                    "isHidden": false,
                                    "columnType": "Data"
                                },
                                {
                                    "name": "QuarternYear",
                                    "dataType": "Int64",
                                    "isHidden": false,
                                    "columnType": "Data"
                                },
                                {
                                    "name": "CurrQuarterOffset",
                                    "dataType": "Int64",
                                    "isHidden": false,
                                    "columnType": "Data"
                                },
                                {
                                    "name": "QuarterCompleted",
                                    "dataType": "Boolean",
                                    "isHidden": false,
                                    "columnType": "Data"
                                },
                                {
                                    "name": "Month",
                                    "dataType": "Int64",
                                    "isHidden": false,
                                    "columnType": "Data"
                                },
                                {
                                    "name": "Start of Month",
                                    "dataType": "DateTime",
                                    "isHidden": false,
                                    "columnType": "Data"
                                },
                                {
                                    "name": "End of Month",
                                    "dataType": "DateTime",
                                    "isHidden": false,
                                    "columnType": "Data"
                                },
                                {
                                    "name": "Month & Year",
                                    "dataType": "String",
                                    "isHidden": false,
                                    "columnType": "Data"
                                },
                                {
                                    "name": "MonthnYear",
                                    "dataType": "Int64",
                                    "isHidden": false,
                                    "columnType": "Data"
                                },
                                {
                                    "name": "CurrMonthOffset",
                                    "dataType": "Int64",
                                    "isHidden": false,
                                    "columnType": "Data"
                                },
                                {
                                    "name": "MonthCompleted",
                                    "dataType": "Boolean",
                                    "isHidden": false,
                                    "columnType": "Data"
                                },
                                {
                                    "name": "Month Name",
                                    "dataType": "String",
                                    "isHidden": false,
                                    "columnType": "Data"
                                },
                                {
                                    "name": "Month Short",
                                    "dataType": "String",
                                    "isHidden": false,
                                    "columnType": "Data"
                                },
                                {
                                    "name": "Month Initial",
                                    "dataType": "String",
                                    "isHidden": false,
                                    "columnType": "Data"
                                },
                                {
                                    "name": "Day of Month",
                                    "dataType": "Int64",
                                    "isHidden": false,
                                    "columnType": "Data"
                                },
                                {
                                    "name": "Week Number",
                                    "dataType": "Int64",
                                    "isHidden": false,
                                    "columnType": "Data"
                                },
                                {
                                    "name": "Start of Week",
                                    "dataType": "DateTime",
                                    "isHidden": false,
                                    "columnType": "Data"
                                },
                                {
                                    "name": "End of Week",
                                    "dataType": "DateTime",
                                    "isHidden": false,
                                    "columnType": "Data"
                                },
                                {
                                    "name": "Week & Year",
                                    "dataType": "String",
                                    "isHidden": false,
                                    "columnType": "Data"
                                },
                                {
                                    "name": "WeeknYear",
                                    "dataType": "Int64",
                                    "isHidden": false,
                                    "columnType": "Data"
                                },
                                {
                                    "name": "CurrWeekOffset",
                                    "dataType": "Int64",
                                    "isHidden": false,
                                    "columnType": "Data"
                                },
                                {
                                    "name": "WeekCompleted",
                                    "dataType": "Boolean",
                                    "isHidden": false,
                                    "columnType": "Data"
                                },
                                {
                                    "name": "Day of Week Number",
                                    "dataType": "Int64",
                                    "isHidden": false,
                                    "columnType": "Data"
                                },
                                {
                                    "name": "Day of Week Name",
                                    "dataType": "String",
                                    "isHidden": false,
                                    "columnType": "Data"
                                },
                                {
                                    "name": "Day of Week Initial",
                                    "dataType": "String",
                                    "isHidden": false,
                                    "columnType": "Data"
                                },
                                {
                                    "name": "DateInt",
                                    "dataType": "Int64",
                                    "isHidden": false,
                                    "columnType": "Data"
                                },
                                {
                                    "name": "CurrDayOffset",
                                    "dataType": "Double",
                                    "isHidden": false,
                                    "columnType": "Data"
                                },
                                {
                                    "name": "IsAfterToday",
                                    "dataType": "Boolean",
                                    "isHidden": false,
                                    "columnType": "Data"
                                },
                                {
                                    "name": "IsWeekDay",
                                    "dataType": "Boolean",
                                    "isHidden": false,
                                    "columnType": "Data"
                                },
                                {
                                    "name": "IsHoliday",
                                    "dataType": "String",
                                    "isHidden": false,
                                    "columnType": "Data"
                                },
                                {
                                    "name": "IsBusinessDay",
                                    "dataType": "Boolean",
                                    "isHidden": false,
                                    "columnType": "Data"
                                },
                                {
                                    "name": "Day Type",
                                    "dataType": "String",
                                    "isHidden": false,
                                    "columnType": "Data"
                                },
                                {
                                    "name": "ISO Year",
                                    "dataType": "Double",
                                    "isHidden": false,
                                    "columnType": "Data"
                                },
                                {
                                    "name": "ISO CurrYearOffset",
                                    "dataType": "Int64",
                                    "isHidden": false,
                                    "columnType": "Data"
                                },
                                {
                                    "name": "ISO Quarter",
                                    "dataType": "String",
                                    "isHidden": false,
                                    "columnType": "Data"
                                },
                                {
                                    "name": "ISO Quarter & Year",
                                    "dataType": "String",
                                    "isHidden": false,
                                    "columnType": "Data"
                                },
                                {
                                    "name": "ISO QuarternYear",
                                    "dataType": "Int64",
                                    "isHidden": false,
                                    "columnType": "Data"
                                },
                                {
                                    "name": "ISO CurrQuarterOffset",
                                    "dataType": "Int64",
                                    "isHidden": false,
                                    "columnType": "Data"
                                },
                                {
                                    "name": "IsCurrentFY",
                                    "dataType": "Boolean",
                                    "isHidden": false,
                                    "columnType": "Data"
                                },
                                {
                                    "name": "IsPYTD",
                                    "dataType": "Boolean",
                                    "isHidden": false,
                                    "columnType": "Data"
                                },
                                {
                                    "name": "IsPFYTD",
                                    "dataType": "Boolean",
                                    "isHidden": false,
                                    "columnType": "Data"
                                },
                                {
                                    "name": "DoW",
                                    "dataType": "String",
                                    "isHidden": false,
                                    "expression": "CONCATENATE(LEFT('Calendar'[Day of Week Name],3),\" \"&'Calendar'[Day Ordinals])",
                                    "columnType": "Calculated"
                                },
                                {
                                    "name": "Day Ordinals",
                                    "dataType": "String",
                                    "isHidden": false,
                                    "expression": "\nVar Last2Digits = RIGHT('Calendar'[Day of Month],2)\nVar LastDigit = RIGHT('Calendar'[Day of Month],1)\nVar Ordination =\n    SWITCH(TRUE(),\n        Last2Digits IN {\"11\",\"12\",\"13\"},\"th\",\n        LastDigit = \"1\" , \"st\",\n        LastDigit  = \"2\",\"nd\",\n        LastDigit = \"3\", \"rd\",\n        \"th\"\n    )\nRETURN\nCONCATENATE('Calendar'[Day of Month],Ordination)",
                                    "columnType": "Calculated"
                                }
                            ],
                            "measures": [],
                            "source": [
                                {
                                    "expression": "let\n    Source = Query1(#date(2020, 1, 1), #date(2026, 12, 31), null, null, 1, null)\nin\n    Source"
                                }
                            ]
                        },
                        {
                            "name": "_Totals",
                            "isHidden": false,
                            "storageMode": "Import",
                            "columns": [
                                {
                                    "name": "Value",
                                    "dataType": "String",
                                    "isHidden": false,
                                    "columnType": "CalculatedTableColumn"
                                }
                            ],
                            "measures": [
                                {
                                    "name": "Total Sales",
                                    "expression": "\nSUM(Sales[Price])",
                                    "isHidden": false
                                },
                                {
                                    "name": "Cash Sales",
                                    "expression": "\nCALCULATE([Total Sales],\n    FILTER(Sales,\n        Sales[Customer]=\"Cash Customer\"\n    )\n)",
                                    "isHidden": false
                                },
                                {
                                    "name": "Credit Sales",
                                    "expression": "\nCALCULATE([Total Sales],\n    FILTER(Sales,\n        Sales[Customer]<>\"Cash Customer\"\n    )\n)",
                                    "isHidden": false
                                },
                                {
                                    "name": "Total Cost",
                                    "expression": "Sum(Sales[Cost])",
                                    "isHidden": false
                                },
                                {
                                    "name": "Total Profit",
                                    "expression": "Sum(Sales[Profit])",
                                    "isHidden": false
                                },
                                {
                                    "name": "Total Sales Title",
                                    "expression": "\" Total Sales\"",
                                    "isHidden": false
                                }
                            ],
                            "source": [
                                {
                                    "expression": "{0}"
                                }
                            ]
                        },
                        {
                            "name": "01_Current Week",
                            "isHidden": false,
                            "storageMode": "Import",
                            "columns": [
                                {
                                    "name": "Value",
                                    "dataType": "String",
                                    "isHidden": false,
                                    "columnType": "CalculatedTableColumn"
                                }
                            ],
                            "measures": [
                                {
                                    "name": "This Week Title",
                                    "expression": "\"This Week\"",
                                    "isHidden": false
                                }
                            ],
                            "source": [
                                {
                                    "expression": "{0}"
                                }
                            ]
                        },
                        {
                            "name": "02_Previous Week",
                            "isHidden": false,
                            "storageMode": "Import",
                            "columns": [
                                {
                                    "name": "Value",
                                    "dataType": "String",
                                    "isHidden": false,
                                    "columnType": "CalculatedTableColumn"
                                }
                            ],
                            "measures": [
                                {
                                    "name": "Prev Week Title",
                                    "expression": "\"Last Week\"",
                                    "isHidden": false
                                }
                            ],
                            "source": [
                                {
                                    "expression": "{0}"
                                }
                            ]
                        },
                        {
                            "name": "03_Current Month",
                            "isHidden": false,
                            "storageMode": "Import",
                            "columns": [
                                {
                                    "name": "Value",
                                    "dataType": "String",
                                    "isHidden": false,
                                    "columnType": "CalculatedTableColumn"
                                }
                            ],
                            "measures": [
                                {
                                    "name": "This Month Sales",
                                    "expression": "\nCALCULATE(_Totals[Total Sales],\n    FILTER('Calendar','Calendar'[CurrMonthOffset]=0)\n)",
                                    "isHidden": false
                                },
                                {
                                    "name": "This Month Title",
                                    "expression": "\"This Month\"",
                                    "isHidden": false
                                }
                            ],
                            "source": [
                                {
                                    "expression": "{0}"
                                }
                            ]
                        },
                        {
                            "name": "04_Previous Month",
                            "isHidden": false,
                            "storageMode": "Import",
                            "columns": [
                                {
                                    "name": "Value",
                                    "dataType": "String",
                                    "isHidden": false,
                                    "columnType": "CalculatedTableColumn"
                                }
                            ],
                            "measures": [
                                {
                                    "name": "Curr Month Prev Year Sales",
                                    "expression": "\nCALCULATE(_Totals[Total Sales],\n FILTER('Calendar','Calendar'[CurrMonthOffset]=-12)\n)",
                                    "isHidden": false
                                },
                                {
                                    "name": "Prev Month Title",
                                    "expression": "\"Last Month\"",
                                    "isHidden": false
                                }
                            ],
                            "source": [
                                {
                                    "expression": "{0}"
                                }
                            ]
                        },
                        {
                            "name": "05_Current Year",
                            "isHidden": false,
                            "storageMode": "Import",
                            "columns": [
                                {
                                    "name": "Value",
                                    "dataType": "String",
                                    "isHidden": false,
                                    "columnType": "CalculatedTableColumn"
                                }
                            ],
                            "measures": [
                                {
                                    "name": "This Year Title",
                                    "expression": "\"This Year\"",
                                    "isHidden": false
                                }
                            ],
                            "source": [
                                {
                                    "expression": "{0}"
                                }
                            ]
                        },
                        {
                            "name": "06_Previous Year",
                            "isHidden": false,
                            "storageMode": "Import",
                            "columns": [
                                {
                                    "name": "Value",
                                    "dataType": "String",
                                    "isHidden": false,
                                    "columnType": "CalculatedTableColumn"
                                }
                            ],
                            "measures": [
                                {
                                    "name": "Prev Year Title",
                                    "expression": "\"Last Year\"",
                                    "isHidden": false
                                }
                            ],
                            "source": [
                                {
                                    "expression": "{0}"
                                }
                            ]
                        },
                        {
                            "name": "_Subs",
                            "isHidden": false,
                            "storageMode": "Import",
                            "columns": [
                                {
                                    "name": "Value",
                                    "dataType": "String",
                                    "isHidden": false,
                                    "columnType": "CalculatedTableColumn"
                                }
                            ],
                            "measures": [
                                {
                                    "name": "Selected Date",
                                    "expression": "SELECTEDVALUE('Calendar'[Date])",
                                    "isHidden": false
                                },
                                {
                                    "name": "Selected Month",
                                    "expression": "SELECTEDVALUE('Calendar'[Month Short])",
                                    "isHidden": false
                                },
                                {
                                    "name": "Selected DoW",
                                    "expression": "SELECTEDVALUE('Calendar'[DoW])",
                                    "isHidden": false
                                },
                                {
                                    "name": "Selected Year",
                                    "expression": "SELECTEDVALUE('Calendar'[Year])",
                                    "isHidden": false
                                },
                                {
                                    "name": "Date Combo",
                                    "expression": "[Selected DoW]&\"-\"&[Selected Month]&\"-\"&[Selected Year]",
                                    "isHidden": false
                                }
                            ],
                            "source": [
                                {
                                    "expression": "{0}"
                                }
                            ]
                        },
                        {
                            "name": "Orders",
                            "isHidden": false,
                            "storageMode": "Import",
                            "columns": [
                                {
                                    "name": "date",
                                    "dataType": "DateTime",
                                    "isHidden": false,
                                    "columnType": "Data"
                                },
                                {
                                    "name": "customer",
                                    "dataType": "String",
                                    "isHidden": false,
                                    "columnType": "Data"
                                },
                                {
                                    "name": "amount",
                                    "dataType": "Double",
                                    "isHidden": false,
                                    "columnType": "Data"
                                },
                                {
                                    "name": "order_id",
                                    "dataType": "Int64",
                                    "isHidden": false,
                                    "columnType": "Data"
                                },
                                {
                                    "name": "balance",
                                    "dataType": "Double",
                                    "isHidden": false,
                                    "columnType": "Data"
                                },
                                {
                                    "name": "status",
                                    "dataType": "String",
                                    "isHidden": false,
                                    "columnType": "Data"
                                },
                                {
                                    "name": "memo",
                                    "dataType": "String",
                                    "isHidden": false,
                                    "columnType": "Data"
                                },
                                {
                                    "name": "user",
                                    "dataType": "String",
                                    "isHidden": false,
                                    "columnType": "Data"
                                }
                            ],
                            "measures": [],
                            "source": [
                                {
                                    "expression": "let\n    Source = MySQL.Database(\"vsamautomation.com\", \"vsamaut1_waziri\", [ReturnSingleDatabase=true, CreateNavigationProperties=false]),\n    vsamaut1_waziri_orders = Source{[Schema=\"vsamaut1_waziri\",Item=\"orders\"]}[Data]\nin\n    vsamaut1_waziri_orders"
                                }
                            ]
                        },
                        {
                            "name": "Sales",
                            "isHidden": false,
                            "storageMode": "Import",
                            "columns": [
                                {
                                    "name": "date",
                                    "dataType": "DateTime",
                                    "isHidden": false,
                                    "columnType": "Data"
                                },
                                {
                                    "name": "order_id",
                                    "dataType": "Int64",
                                    "isHidden": false,
                                    "columnType": "Data"
                                },
                                {
                                    "name": "customer",
                                    "dataType": "String",
                                    "isHidden": false,
                                    "columnType": "Data"
                                },
                                {
                                    "name": "item",
                                    "dataType": "String",
                                    "isHidden": false,
                                    "columnType": "Data"
                                },
                                {
                                    "name": "part_no",
                                    "dataType": "String",
                                    "isHidden": false,
                                    "columnType": "Data"
                                },
                                {
                                    "name": "make",
                                    "dataType": "String",
                                    "isHidden": false,
                                    "columnType": "Data"
                                },
                                {
                                    "name": "position",
                                    "dataType": "String",
                                    "isHidden": false,
                                    "columnType": "Data"
                                },
                                {
                                    "name": "qty",
                                    "dataType": "Int64",
                                    "isHidden": false,
                                    "columnType": "Data"
                                },
                                {
                                    "name": "invoice_no",
                                    "dataType": "String",
                                    "isHidden": false,
                                    "columnType": "Data"
                                },
                                {
                                    "name": "price",
                                    "dataType": "Double",
                                    "isHidden": false,
                                    "columnType": "Data"
                                },
                                {
                                    "name": "cost",
                                    "dataType": "Double",
                                    "isHidden": false,
                                    "columnType": "Data"
                                },
                                {
                                    "name": "profit",
                                    "dataType": "Double",
                                    "isHidden": false,
                                    "columnType": "Data"
                                },
                                {
                                    "name": "profit%",
                                    "dataType": "Double",
                                    "isHidden": false,
                                    "columnType": "Data"
                                },
                                {
                                    "name": "vehicle_make",
                                    "dataType": "String",
                                    "isHidden": false,
                                    "columnType": "Data"
                                },
                                {
                                    "name": "model",
                                    "dataType": "String",
                                    "isHidden": false,
                                    "columnType": "Data"
                                },
                                {
                                    "name": "engine_type",
                                    "dataType": "String",
                                    "isHidden": false,
                                    "columnType": "Data"
                                },
                                {
                                    "name": "vat",
                                    "dataType": "Double",
                                    "isHidden": false,
                                    "columnType": "Data"
                                },
                                {
                                    "name": "memo",
                                    "dataType": "String",
                                    "isHidden": false,
                                    "columnType": "Data"
                                },
                                {
                                    "name": "user",
                                    "dataType": "String",
                                    "isHidden": false,
                                    "columnType": "Data"
                                },
                                {
                                    "name": "id",
                                    "dataType": "Int64",
                                    "isHidden": false,
                                    "columnType": "Data"
                                }
                            ],
                            "measures": [],
                            "source": [
                                {
                                    "expression": "let\n    Source = MySQL.Database(\"vsamautomation.com\", \"vsamaut1_waziri\", [ReturnSingleDatabase=true]),\n    vsamaut1_waziri_items_sales = Source{[Schema=\"vsamaut1_waziri\",Item=\"items_sales\"]}[Data]\nin\n    vsamaut1_waziri_items_sales"
                                }
                            ]
                        },
                        {
                            "name": "waz_stock_movement",
                            "isHidden": false,
                            "storageMode": "Import",
                            "columns": [
                                {
                                    "name": "id",
                                    "dataType": "Int64",
                                    "isHidden": false,
                                    "columnType": "Data"
                                },
                                {
                                    "name": "item",
                                    "dataType": "String",
                                    "isHidden": false,
                                    "columnType": "Data"
                                },
                                {
                                    "name": "part_no",
                                    "dataType": "String",
                                    "isHidden": false,
                                    "columnType": "Data"
                                },
                                {
                                    "name": "prev_bal",
                                    "dataType": "Double",
                                    "isHidden": false,
                                    "columnType": "Data"
                                },
                                {
                                    "name": "qty",
                                    "dataType": "Int64",
                                    "isHidden": false,
                                    "columnType": "Data"
                                },
                                {
                                    "name": "movement_type",
                                    "dataType": "String",
                                    "isHidden": false,
                                    "columnType": "Data"
                                },
                                {
                                    "name": "movement_id",
                                    "dataType": "Int64",
                                    "isHidden": false,
                                    "columnType": "Data"
                                },
                                {
                                    "name": "user",
                                    "dataType": "String",
                                    "isHidden": false,
                                    "columnType": "Data"
                                },
                                {
                                    "name": "date",
                                    "dataType": "DateTime",
                                    "isHidden": false,
                                    "columnType": "Data"
                                }
                            ],
                            "measures": [],
                            "source": [
                                {
                                    "expression": "let\n    Source = MySQL.Database(\"vsamautomation.com\", \"vsamaut1_waziri\", [ReturnSingleDatabase=true]),\n    vsamaut1_waziri_stock_movement = Source{[Schema=\"vsamaut1_waziri\",Item=\"stock_movement\"]}[Data]\nin\n    vsamaut1_waziri_stock_movement"
                                }
                            ]
                        },
                        {
                            "name": "CustomersDB",
                            "isHidden": false,
                            "storageMode": "Import",
                            "columns": [
                                {
                                    "name": "id",
                                    "dataType": "Int64",
                                    "isHidden": false,
                                    "columnType": "Data"
                                },
                                {
                                    "name": "customer name",
                                    "dataType": "String",
                                    "isHidden": false,
                                    "columnType": "Data"
                                },
                                {
                                    "name": "mobile",
                                    "dataType": "String",
                                    "isHidden": false,
                                    "columnType": "Data"
                                },
                                {
                                    "name": "address",
                                    "dataType": "String",
                                    "isHidden": false,
                                    "columnType": "Data"
                                },
                                {
                                    "name": "balance",
                                    "dataType": "Double",
                                    "isHidden": false,
                                    "columnType": "Data"
                                },
                                {
                                    "name": "status",
                                    "dataType": "String",
                                    "isHidden": false,
                                    "columnType": "Data"
                                }
                            ],
                            "measures": [],
                            "source": [
                                {
                                    "expression": "let\n    Source = MySQL.Database(\"vsamautomation.com\", \"vsamaut1_waziri\", [ReturnSingleDatabase=true]),\n    vsamaut1_waziri_customers = Source{[Schema=\"vsamaut1_waziri\",Item=\"customers\"]}[Data]\nin\n    vsamaut1_waziri_customers"
                                }
                            ]
                        },
                        {
                            "name": "Payments",
                            "isHidden": false,
                            "storageMode": "Import",
                            "columns": [
                                {
                                    "name": "date",
                                    "dataType": "DateTime",
                                    "isHidden": false,
                                    "columnType": "Data"
                                },
                                {
                                    "name": "customer",
                                    "dataType": "String",
                                    "isHidden": false,
                                    "columnType": "Data"
                                },
                                {
                                    "name": "amount",
                                    "dataType": "Double",
                                    "isHidden": false,
                                    "columnType": "Data"
                                },
                                {
                                    "name": "memo",
                                    "dataType": "String",
                                    "isHidden": false,
                                    "columnType": "Data"
                                },
                                {
                                    "name": "mode_of_payment",
                                    "dataType": "String",
                                    "isHidden": false,
                                    "columnType": "Data"
                                },
                                {
                                    "name": "status",
                                    "dataType": "String",
                                    "isHidden": false,
                                    "columnType": "Data"
                                },
                                {
                                    "name": "balance",
                                    "dataType": "Double",
                                    "isHidden": false,
                                    "columnType": "Data"
                                },
                                {
                                    "name": "order_id",
                                    "dataType": "String",
                                    "isHidden": false,
                                    "columnType": "Data"
                                },
                                {
                                    "name": "id",
                                    "dataType": "Int64",
                                    "isHidden": false,
                                    "columnType": "Data"
                                },
                                {
                                    "name": "user",
                                    "dataType": "String",
                                    "isHidden": false,
                                    "columnType": "Data"
                                }
                            ],
                            "measures": [],
                            "source": [
                                {
                                    "expression": "let\n    Source = MySQL.Database(\"vsamautomation.com\", \"vsamaut1_waziri\", [ReturnSingleDatabase=true]),\n    vsamaut1_waziri_cust_payments = Source{[Schema=\"vsamaut1_waziri\",Item=\"cust_payments\"]}[Data]\nin\n    vsamaut1_waziri_cust_payments"
                                }
                            ]
                        },
                        {
                            "name": "ItemsDB",
                            "isHidden": false,
                            "storageMode": "Import",
                            "columns": [
                                {
                                    "name": "part number",
                                    "dataType": "String",
                                    "isHidden": false,
                                    "columnType": "Data"
                                },
                                {
                                    "name": "item name",
                                    "dataType": "String",
                                    "isHidden": false,
                                    "columnType": "Data"
                                },
                                {
                                    "name": "vehicle make",
                                    "dataType": "String",
                                    "isHidden": false,
                                    "columnType": "Data"
                                },
                                {
                                    "name": "vehicle model",
                                    "dataType": "String",
                                    "isHidden": false,
                                    "columnType": "Data"
                                },
                                {
                                    "name": "engine type",
                                    "dataType": "String",
                                    "isHidden": false,
                                    "columnType": "Data"
                                },
                                {
                                    "name": "stock balance",
                                    "dataType": "Int64",
                                    "isHidden": false,
                                    "columnType": "Data"
                                },
                                {
                                    "name": "unit cost",
                                    "dataType": "Double",
                                    "isHidden": false,
                                    "columnType": "Data"
                                },
                                {
                                    "name": "stock value",
                                    "dataType": "Double",
                                    "isHidden": false,
                                    "columnType": "Data"
                                },
                                {
                                    "name": "product image",
                                    "dataType": "String",
                                    "isHidden": false,
                                    "columnType": "Data"
                                },
                                {
                                    "name": "image url",
                                    "dataType": "String",
                                    "isHidden": false,
                                    "columnType": "Data"
                                },
                                {
                                    "name": "category",
                                    "dataType": "String",
                                    "isHidden": false,
                                    "columnType": "Data"
                                }
                            ],
                            "measures": [],
                            "source": [
                                {
                                    "expression": "let\n    Source = MySQL.Database(\"vsamautomation.com\", \"vsamaut1_waziri\", [ReturnSingleDatabase=true]),\n    vsamaut1_waziri_items = Source{[Schema=\"vsamaut1_waziri\",Item=\"items\"]}[Data]\nin\n    vsamaut1_waziri_items"
                                }
                            ]
                        },
                        {
                            "name": "hpeqhdmy_salesapp vehicles",
                            "isHidden": false,
                            "storageMode": "Import",
                            "columns": [
                                {
                                    "name": "Vehicle_Make",
                                    "dataType": "String",
                                    "isHidden": false,
                                    "columnType": "Data"
                                },
                                {
                                    "name": "id",
                                    "dataType": "Int64",
                                    "isHidden": false,
                                    "columnType": "Data"
                                }
                            ],
                            "measures": [],
                            "source": [
                                {
                                    "expression": "let\n    Source = MySQL.Database(\"vsamautomation.com\", \"vsamaut1_waziri\", [ReturnSingleDatabase=true]),\n    vsamaut1_waziri_vehicles = Source{[Schema=\"vsamaut1_waziri\",Item=\"vehicles\"]}[Data]\nin\n    vsamaut1_waziri_vehicles"
                                }
                            ]
                        },
                        {
                            "name": "waz_item_make",
                            "isHidden": false,
                            "storageMode": "Import",
                            "columns": [
                                {
                                    "name": "id",
                                    "dataType": "Int64",
                                    "isHidden": false,
                                    "columnType": "Data"
                                },
                                {
                                    "name": "MIK",
                                    "dataType": "String",
                                    "isHidden": false,
                                    "columnType": "Data"
                                }
                            ],
                            "measures": [],
                            "source": [
                                {
                                    "expression": "let\n    Source = MySQL.Database(\"vsamautomation.com\", \"vsamaut1_waziri\", [ReturnSingleDatabase=true]),\n    vsamaut1_waziri_item_make = Source{[Schema=\"vsamaut1_waziri\",Item=\"item_make\"]}[Data]\nin\n    vsamaut1_waziri_item_make"
                                }
                            ]
                        }
                    ],
                    "expressions": [
                        {
                            "name": "Query1",
                            "expression": "let\n    Source = let fnDateTable = ( StartDate as date, EndDate as date, optional FYStartMonthNum as number, optional Holidays as list, optional WDStartNum as number, optional AddRelativeNetWorkdays as logical ) as table =>\n  let\n      FYStartMonth = List.Select( {1..12}, each _ = FYStartMonthNum ){0}? ?? 1,\n      WDStart = List.Select( {0..1}, each _ = WDStartNum ){0}? ?? 0,\n      CurrentDate = Date.From(DateTime.LocalNow()), //#date(2023,12,31),\n      DayCount = Duration.Days( Duration.From( EndDate - StartDate)) +1,\n      Source = List.Dates( StartDate, DayCount, #duration(1,0,0,0)),\n      AddToday = if EndDate < CurrentDate then List.Combine( {Source, {CurrentDate}}) else Source,\n      ToTable = Table.FromList(AddToday, Splitter.SplitByNothing(), type table [Date = Date.Type] ),\n      InsertYear = Table.AddColumn(ToTable, \"Year\", each Date.Year([Date]), type number),\n      InsertYearOffset = Table.AddColumn(InsertYear, \"CurrYearOffset\", each Date.Year([Date]) - Date.Year( Date.From(CurrentDate)), type number),\n      InsertCompletedYear = Table.AddColumn(InsertYearOffset, \"YearCompleted\", each Date.EndOfYear([Date]) < Date.From( Date.EndOfYear(CurrentDate)), type logical),\n\n      InsertQuarterNum = Table.AddColumn(InsertCompletedYear, \"Quarter Number\", each Date.QuarterOfYear([Date]), type number),\n      InsertQuarter = Table.AddColumn(InsertQuarterNum, \"Quarter\", each \"Q\" & Number.ToText([Quarter Number]), type text),\n      InsertStartOfQuarter = Table.AddColumn(InsertQuarter, \"Start of Quarter\", each Date.StartOfQuarter([Date]), type date),\n      InsertEndOfQuarter = Table.AddColumn(InsertStartOfQuarter, \"End of Quarter\", each Date.EndOfQuarter([Date]), type date),\n      InsertCalendarQtr = Table.AddColumn(InsertEndOfQuarter, \"Quarter & Year\", each \"Q\" & Number.ToText( Date.QuarterOfYear([Date])) & Date.ToText([Date], [Format = \" yyyy\"]), type text),\n      InsertQuarternYear = Table.AddColumn(InsertCalendarQtr, \"QuarternYear\", each [Year] * 10 + [Quarter Number], type number),\n      InsertQuarterOffset = Table.AddColumn(InsertQuarternYear, \"CurrQuarterOffset\", each ((4 * Date.Year([Date])) +  Date.QuarterOfYear([Date])) - ((4 * Date.Year(Date.From(CurrentDate))) +  Date.QuarterOfYear(Date.From(CurrentDate))), type number),\n      InsertCompletedQuarter = Table.AddColumn(InsertQuarterOffset, \"QuarterCompleted\", each Date.EndOfQuarter([Date]) < Date.From(Date.EndOfQuarter(CurrentDate)), type logical),\n\n      InsertMonth = Table.AddColumn(InsertCompletedQuarter, \"Month\", each Date.Month([Date]), type number),\n      InsertStartOfMonth = Table.AddColumn(InsertMonth, \"Start of Month\", each Date.StartOfMonth([Date]), type date),\n      InsertEndOfMonth = Table.AddColumn(InsertStartOfMonth, \"End of Month\", each Date.EndOfMonth([Date]), type date),\n      InsertCalendarMonth = Table.AddColumn(InsertEndOfMonth, \"Month & Year\", each Text.Proper( Date.ToText([Date], [Format = \"MMM yyyy\"])), type text),\n      InsertMonthnYear = Table.AddColumn(InsertCalendarMonth , \"MonthnYear\", each [Year] * 100 + [Month], type number),\n      InsertMonthOffset = Table.AddColumn(InsertMonthnYear, \"CurrMonthOffset\", each ((12 * Date.Year([Date])) +  Date.Month([Date])) - ((12 * Date.Year(Date.From(CurrentDate))) +  Date.Month(Date.From(CurrentDate))), type number),\n      InsertCompletedMonth = Table.AddColumn(InsertMonthOffset, \"MonthCompleted\", each Date.EndOfMonth([Date]) < Date.From(Date.EndOfMonth(CurrentDate)), type logical),\n      InsertMonthName = Table.AddColumn(InsertCompletedMonth, \"Month Name\", each Text.Proper( Date.ToText([Date], \"MMMM\")), type text),\n      InsertMonthShort = Table.AddColumn( InsertMonthName, \"Month Short\", each Text.Proper( Date.ToText([Date], \"MMM\")), type text),\n      InsertMonthInitial = Table.AddColumn(InsertMonthShort, \"Month Initial\", each Text.Start([Month Name], 1) & Text.Repeat( Character.FromNumber(8203), Date.Month([Date]) ), type text),\n      InsertDayOfMonth = Table.AddColumn(InsertMonthInitial, \"Day of Month\", each Date.Day([Date]), type number),\n  \n      InsertWeekNumber = Table.AddColumn(InsertDayOfMonth, \"Week Number\", each\n        if Number.RoundDown((Date.DayOfYear([Date])-(Date.DayOfWeek([Date], Day.Monday)+1)+10)/7)=0\n        then Number.RoundDown((Date.DayOfYear(#date(Date.Year([Date])-1,12,31))-(Date.DayOfWeek(#date(Date.Year([Date])-1,12,31), Day.Monday)+1)+10)/7)\n        else if (Number.RoundDown((Date.DayOfYear([Date])-(Date.DayOfWeek([Date], Day.Monday)+1)+10)/7)=53 and (Date.DayOfWeek(#date(Date.Year([Date]),12,31), Day.Monday)+1<4))\n        then 1 else Number.RoundDown((Date.DayOfYear([Date])-(Date.DayOfWeek([Date], Day.Monday)+1)+10)/7), type number),\n      InsertStartOfWeek = Table.AddColumn(InsertWeekNumber, \"Start of Week\", each Date.StartOfWeek([Date], Day.Monday), type date),\n      InsertWeekEnding = Table.AddColumn(InsertStartOfWeek, \"End of Week\", each Date.EndOfWeek( [Date], Day.Monday), type date),\n      InsertCalendarWk = Table.AddColumn(InsertWeekEnding, \"Week & Year\", each \"W\" & Text.PadStart( Text.From( [Week Number] ), 2, \"0\") & \" \" & Text.From(Date.Year( Date.AddDays( Date.StartOfWeek([Date], Day.Monday), 3 ))), type text ),\n      InsertWeeknYear = Table.AddColumn(InsertCalendarWk, \"WeeknYear\", each Date.Year( Date.AddDays( Date.StartOfWeek([Date], Day.Monday), 3 )) * 100 + [Week Number],  Int64.Type),\n      InsertWeekOffset = Table.AddColumn(InsertWeeknYear, \"CurrWeekOffset\", each (Number.From(Date.StartOfWeek([Date], Day.Monday))-Number.From(Date.StartOfWeek(CurrentDate, Day.Monday)))/7, type number),\n      InsertCompletedWeek = Table.AddColumn(InsertWeekOffset, \"WeekCompleted\", each Date.EndOfWeek( [Date], Day.Monday) < Date.From(Date.EndOfWeek(CurrentDate, Day.Monday)), type logical),\n  \n      InsertDayWeek = Table.AddColumn(InsertCompletedWeek, \"Day of Week Number\", each Date.DayOfWeek([Date], Day.Monday) + WDStart, Int64.Type),\n      InsertDayName = Table.AddColumn(InsertDayWeek, \"Day of Week Name\", each Text.Proper( Date.ToText([Date], \"dddd\" )), type text),\n      InsertDayInitial = Table.AddColumn(InsertDayName, \"Day of Week Initial\", each Text.Proper(Text.Start([Day of Week Name], 1)) & Text.Repeat( Character.FromNumber(8203), Date.DayOfWeek([Date], Day.Monday) + WDStart ), type text),\n      InsertDayOfYear = Table.AddColumn(InsertDayInitial, \"Day of Year\", each Date.DayOfYear([Date]), Int64.Type),\n      InsertDayInt = Table.AddColumn(InsertDayOfYear, \"DateInt\", each [Year] * 10000 + [Month] * 100 + [Day of Month], type number),\n      InsertDayOffset = Table.AddColumn(InsertDayInt, \"CurrDayOffset\", each Number.From([Date]) - Number.From(CurrentDate), type number),\n      InsertIsAfterToday = Table.AddColumn(InsertDayOffset, \"IsAfterToday\", each not ([Date] <= Date.From(CurrentDate)), type logical),\n      InsertIsWorkingDay = Table.AddColumn(InsertIsAfterToday, \"IsWeekDay\", each if Date.DayOfWeek([Date], Day.Monday) > 4 then false else true, type logical),\n      InsertIsHoliday = Table.AddColumn(InsertIsWorkingDay, \"IsHoliday\", each if Holidays = null then \"Unknown\" else List.Contains( Holidays, [Date] ), if Holidays = null then type text else type logical),\n      InsertIsBusinessDay = Table.AddColumn(InsertIsHoliday, \"IsBusinessDay\", each if [IsWeekDay] = true and [IsHoliday] <> true then true else false, type logical),\n      InsertDayType = Table.AddColumn(InsertIsBusinessDay, \"Day Type\", each if [IsHoliday] = true then \"Holiday\" else if [IsWeekDay] = false then \"Weekend\" else if [IsWeekDay] = true then \"Weekday\" else null, type text),\n\n      InsertISOYear = Table.AddColumn( InsertDayType, \"ISO Year\", each Date.Year( Date.AddDays( Date.StartOfWeek([Date], Day.Monday), 3 )), type number),\n      InsertISOqNum = Table.AddColumn(InsertISOYear, \"ISO Quarter Number\", each if [Week Number] >39 then 4 else if [Week Number] >26 then 3 else if [Week Number] >13 then 2 else 1, Int64.Type),\n      InsertISOqtr = Table.AddColumn(InsertISOqNum, \"ISO Quarter\", each \"Q\" & Number.ToText([ISO Quarter Number]), type text),\n      InsertISOQuarter = Table.AddColumn(InsertISOqtr, \"ISO Quarter & Year\", each \"Q\" & Number.ToText([ISO Quarter Number]) & \" \" & Number.ToText([ISO Year]), type text),\n      InsertISOqNy = Table.AddColumn(InsertISOQuarter, \"ISO QuarternYear\", each [ISO Year] * 10 + [ISO Quarter Number], type number),\n\n      // BufferTable = Table.Buffer(Table.Distinct( InsertISOqNy[[ISO Year], [DateInt]])),\n      // InsertISOday = Table.AddColumn(InsertISOqNy, \"ISO Day of Year\", (OT) => Table.RowCount( Table.SelectRows( BufferTable, (IT) => IT[DateInt] <= OT[DateInt] and IT[ISO Year] = OT[ISO Year])),  Int64.Type),\n      AddFY = Table.AddColumn(InsertISOqNy, \"Fiscal Year\", each \"FY\" & (if [Month] >= FYStartMonth and FYStartMonth >1 then Text.From([Year] +1) else Text.From([Year])), type text),\n      //AddFYs = Table.AddColumn(AddFY, \"Fiscal Year short\", each \"FY\" & (if [Month] >= FYStartMonth and FYStartMonth >1 then Text.PadEnd( Text.End( Text.From([Year] +1), 2), 2, \"0\") else Text.End( Text.From([Year]), 2)), type text),\n      AddFQ = Table.AddColumn(AddFY, \"Fiscal Quarter\", each \"FQ\" & Text.From( Number.RoundUp( Date.Month( Date.AddMonths( [Date], - (FYStartMonth -1) )) / 3 )) & \" \" & (if [Month] >= FYStartMonth and FYStartMonth >1 then Text.From([Year] +1) else Text.From([Year])), type text),\n      AddFQnYr = Table.AddColumn(AddFQ, \"FQuarternYear\", each (if [Month] >= FYStartMonth and FYStartMonth >1 then [Year] +1 else [Year]) * 10 + Number.RoundUp( Date.Month( Date.AddMonths( [Date], - (FYStartMonth -1) )) / 3 ), type number),\n      AddFM = Table.AddColumn(AddFQnYr, \"Fiscal Period Number\", each if [Month] >= FYStartMonth and FYStartMonth >1 then [Month] - (FYStartMonth-1) else if [Month] >= FYStartMonth and FYStartMonth =1 then [Month] else [Month] + (12-FYStartMonth+1), type number),\n      AddFP = Table.AddColumn(AddFM, \"Fiscal Period\", each \"FP\" & Text.PadStart( Text.From([Fiscal Period Number]), 2, \"0\") & \" \" & (if [Month] >= FYStartMonth and FYStartMonth >1 then Text.From([Year] +1) else Text.From([Year])), type text),\n      AddFMnYr = Table.AddColumn(AddFP , \"FPeriodnYear\", each (if [Month] >= FYStartMonth and FYStartMonth >1 then [Year] +1 else [Year]) * 100 + [Fiscal Period Number], type number),\n      FYCalendarStart = #date( Date.Year(StartDate)-1, FYStartMonth, 1 ),\n      InsertFFD = Table.AddColumn( AddFMnYr, \"FiscalFirstDay\", each if [Month] >= FYStartMonth and FYStartMonth >1 then #date( Date.Year([Date])+1, FYStartMonth, 1) else #date( Date.Year([Date]), FYStartMonth, 1), type date ),\n\n      InitTable = Table.FromList( List.Transform( {Number.From(FYCalendarStart) .. Number.From(EndDate)}, Date.From), Splitter.SplitByNothing(), type table [DateFW = Date.Type]),\n      AddFFD = Table.AddColumn( InitTable, \"FiscalFirstDay\", each if Date.Month([DateFW]) < FYStartMonth then #date(Date.Year([DateFW]), FYStartMonth, 1) else #date(Date.Year([DateFW]) + 1, FYStartMonth, 1)),\n      AddFWSD = Table.AddColumn( AddFFD, \"FWStartDate\", each Date.AddYears(Date.StartOfWeek([DateFW], Day.Monday), 1)),\n      Group1 = Table.Group( AddFWSD, {\"FiscalFirstDay\", \"FWStartDate\"}, {{\"AllRows\", each _, type table [DateFW = nullable date, FiscalFirstDay = date, FWStartDate = date]}}),\n      Group2 = Table.Group( Group1, {\"FiscalFirstDay\"}, {{\"AllRows2\", each _, type table [FiscalFirstDay = date, FWStartDate = date, AllRows = table]}}),\n      AddIndex = Table.AddColumn( Group2, \"Custom\", each Table.AddIndexColumn([AllRows2], \"Fiscal Week Number\", 1, 1) )[[Custom]],\n      ExpandG2 = Table.ExpandTableColumn( AddIndex, \"Custom\", {\"FiscalFirstDay\", \"FWStartDate\", \"AllRows\", \"Fiscal Week Number\"}, {\"FiscalFirstDay\", \"FWStartDate\", \"AllRows\", \"Fiscal Week Number\"}), \n      ExpandG1 = Table.ExpandTableColumn( ExpandG2, \"AllRows\", {\"DateFW\"}, {\"DateFW\"} )[[DateFW], [Fiscal Week Number]],\n      MergeFYW = Table.Join( InsertFFD, {\"Date\"}, ExpandG1, {\"DateFW\"}, JoinKind.LeftOuter, JoinAlgorithm.SortMerge ),\n      FWlogic = List.Contains( {null}, FYStartMonthNum),\n      UpdateFYWeek = if FWlogic then Table.ReplaceValue(MergeFYW, each [Fiscal Week Number], each if FYStartMonth =1 then [Week Number] else [Fiscal Week Number], Replacer.ReplaceValue, {\"Fiscal Week Number\"}) else MergeFYW,\n      AddFYW = Table.AddColumn( UpdateFYWeek, \"Fiscal Week\", each if FWlogic then \"F\" & [#\"Week & Year\"] else if FYStartMonth =1 then \"FW\" & Text.PadStart( Text.From([Fiscal Week Number]), 2, \"0\") & Date.ToText([Date], \" yyyy\") else if Date.Month([Date]) < FYStartMonth then \"FW\" & Text.PadStart( Text.From([Fiscal Week Number]), 2, \"0\") & Date.ToText([Date], \" yyyy\") else \"FW\" & Text.PadStart(Text.From([Fiscal Week Number]), 2, \"0\") & \" \" & Text.From( Date.Year([Date])+1), type text),\n      InsertFWeeknYear = Table.AddColumn(AddFYW, \"FWeeknYear\", each if FWlogic then [WeeknYear] else (if FYStartMonth =1 then Date.Year([Date]) else if Date.Month([Date]) < FYStartMonth then Date.Year([Date]) else Date.Year([Date])+1) * 100 + [Fiscal Week Number],  Int64.Type),\n      \n      CurrentDateRecord = Table.SelectRows(InsertFWeeknYear, each ([Date] = CurrentDate)),\n      CurrentISOyear = CurrentDateRecord{0}[ISO Year],\n      CurrentISOqtr = CurrentDateRecord{0}[ISO Quarter Number],\n      CurrentYear = CurrentDateRecord{0}[Year],\n      CurrentMonth = CurrentDateRecord{0}[Month],\n      CurrentFiscalFirstDay = CurrentDateRecord{0}[FiscalFirstDay],\n      PrevFiscalFirstDay = Date.AddYears(CurrentFiscalFirstDay, -1),\n      CurrentFY = CurrentDateRecord{0}[Fiscal Year],\n      CurrentFQ = CurrentDateRecord{0}[FQuarternYear],\n      CurrentFP = CurrentDateRecord{0}[FPeriodnYear],\n      CurrentFW = CurrentDateRecord{0}[FWeeknYear],\n\n      InsertISOYrOffset = Table.AddColumn(InsertFWeeknYear, \"ISO CurrYearOffset\", each [ISO Year] - CurrentISOyear, type number),\n      InsertISOQtrOffset = Table.AddColumn(InsertISOYrOffset, \"ISO CurrQuarterOffset\", each ((4 * [ISO Year]) +  [ISO Quarter Number]) - ((4 * CurrentISOyear) + CurrentISOqtr), type number),\n      InsertFYoffset = Table.AddColumn(InsertISOQtrOffset, \"Fiscal CurrYearOffset\", each try (if [Month] >= FYStartMonth then [Year]+1 else [Year]) - (if CurrentMonth >= FYStartMonth then CurrentYear+1 else CurrentYear) otherwise null, type number),\n      InsertCurrentFY = Table.AddColumn(InsertFYoffset, \"IsCurrentFY\", each if [Fiscal Year] = CurrentFY then true else false, type logical),\n      InsertCurrentFQ = Table.AddColumn(InsertCurrentFY, \"IsCurrentFQ\", each if [FQuarternYear] = CurrentFQ then true else false, type logical),\n      InsertCurrentFP = Table.AddColumn(InsertCurrentFQ, \"IsCurrentFP\", each if [FPeriodnYear] = CurrentFP then true else false, type logical),\n      InsertCurrentFW = Table.AddColumn(InsertCurrentFP, \"IsCurrentFW\", each if [FWeeknYear] = InsertISOYrOffset then true else false, type logical),\n      InsertPYTD = Table.AddColumn(InsertCurrentFW, \"IsPYTD\", each if CurrentYear-1 = [Year] and [Day of Year] <= CurrentDateRecord{0}[Day of Year] then true else false, type logical),\n        ListPrevFYDates = List.Buffer( Table.SelectRows( Table.ExpandTableColumn( Table.NestedJoin(\n            Table.AddIndexColumn( Table.RenameColumns( Table.TransformColumnTypes( Table.FromList( List.Dates( PrevFiscalFirstDay, Number.From(CurrentFiscalFirstDay-PrevFiscalFirstDay),#duration(1,0,0,0)), Splitter.SplitByNothing()),{{\"Column1\", type date}}), {{\"Column1\", \"DateFY\"}}), \"Index\", 1, 1), {\"Index\"}, \n            Table.AddIndexColumn( Table.RenameColumns( Table.TransformColumnTypes( Table.FromList( List.Dates( Date.AddYears( PrevFiscalFirstDay, -1), Number.From( PrevFiscalFirstDay - Date.AddYears( PrevFiscalFirstDay, -1)),#duration(1,0,0,0)), Splitter.SplitByNothing()),{{\"Column1\", type date}}), {{\"Column1\", \"DateFY\"}}), \"Index\", 1, 1)\n            , {\"Index\"}, \"Table\", JoinKind.LeftOuter), \"Table\", {\"DateFY\"}, {\"PrevDateFY\"}), each [DateFY] <= CurrentDate)[PrevDateFY] ),\n      InsertPFYTD = Table.AddColumn(InsertPYTD, \"IsPFYTD\", each if [Fiscal CurrYearOffset] = -1 and List.Contains(ListPrevFYDates, [Date] ) then true else false, type logical),\n      InsertNetWorkdays = if AddRelativeNetWorkdays = true then Table.AddColumn(InsertPFYTD, \"Relative Networkdays\", each fxNETWORKDAYS( StartDate, [Date], Holidays ), type number ) else InsertPFYTD,\n      fxNETWORKDAYS = (StartDate, EndDate, optional Holidays as list) =>\n        let\n          ListOfDates = List.Dates( StartDate, Number.From(EndDate-StartDate)+1, Duration.From(1) ),\n          DeleteHolidays = if Holidays = null then ListOfDates else List.Difference( ListOfDates, List.Transform(Holidays, Date.From )),\n          DeleteWeekends = List.Select( DeleteHolidays, each Date.DayOfWeek( _, Day.Monday) < 5 ),\n          CountDays = List.Count( DeleteWeekends)\n        in\n          CountDays,\n      RemoveToday = Table.RemoveColumns( if EndDate < CurrentDate then Table.SelectRows(InsertNetWorkdays, each ([Date] <> CurrentDate)) else InsertNetWorkdays, {\"Day of Year\", \"FiscalFirstDay\"}), \n      ChType = Table.TransformColumnTypes(RemoveToday,{{\"Year\", Int64.Type}, {\"Quarter Number\", Int64.Type}, {\"Month\", Int64.Type}, {\"Day of Month\", Int64.Type}, {\"DateInt\", Int64.Type}, {\"Day of Week Number\", Int64.Type}, {\"ISO CurrYearOffset\", Int64.Type}, {\"ISO QuarternYear\", Int64.Type}, {\"ISO CurrQuarterOffset\", Int64.Type}, {\"Week Number\", Int64.Type}, {\"WeeknYear\", Int64.Type}, {\"MonthnYear\", Int64.Type}, {\"QuarternYear\", Int64.Type}, {\"FQuarternYear\", Int64.Type}, {\"Fiscal Period Number\", Int64.Type}, {\"FPeriodnYear\", Int64.Type}, {\"CurrWeekOffset\", Int64.Type}, {\"CurrMonthOffset\", Int64.Type}, {\"CurrQuarterOffset\", Int64.Type}, {\"CurrYearOffset\", Int64.Type}, {\"Fiscal CurrYearOffset\", Int64.Type}, {\"Fiscal Week Number\", Int64.Type}}),\n      ReorderCols = Table.ReorderColumns(ChType,{\"Date\", \"Year\", \"CurrYearOffset\", \"YearCompleted\", \"Quarter Number\", \"Quarter\", \"Start of Quarter\", \"End of Quarter\", \"Quarter & Year\", \"QuarternYear\", \"CurrQuarterOffset\", \"QuarterCompleted\", \"Month\", \"Start of Month\", \"End of Month\", \"Month & Year\", \"MonthnYear\", \"CurrMonthOffset\", \"MonthCompleted\", \"Month Name\", \"Month Short\", \"Month Initial\", \"Day of Month\", \"Week Number\", \"Start of Week\", \"End of Week\", \"Week & Year\", \"WeeknYear\", \"CurrWeekOffset\", \"WeekCompleted\", \"Day of Week Number\", \"Day of Week Name\", \"Day of Week Initial\", \"DateInt\", \"CurrDayOffset\", \"IsAfterToday\", \"IsWeekDay\", \"IsHoliday\", \"IsBusinessDay\", \"Day Type\", \"ISO Year\", \"ISO CurrYearOffset\", \"ISO Quarter Number\", \"ISO Quarter\", \"ISO Quarter & Year\", \"ISO QuarternYear\", \"ISO CurrQuarterOffset\", \"Fiscal Year\", \"Fiscal CurrYearOffset\", \"Fiscal Quarter\", \"FQuarternYear\", \"Fiscal Period Number\", \"Fiscal Period\", \"FPeriodnYear\", \"DateFW\", \"Fiscal Week Number\", \"Fiscal Week\", \"FWeeknYear\", \"IsCurrentFY\", \"IsCurrentFQ\", \"IsCurrentFP\", \"IsCurrentFW\", \"IsPYTD\", \"IsPFYTD\"}),\n      ListCols = if FWlogic then Table.RemoveColumns(ReorderCols,{\"ISO Quarter Number\", \"Fiscal Year\", \"Fiscal Quarter\", \"FQuarternYear\", \"Fiscal Period Number\", \"Fiscal Period\", \"FPeriodnYear\", \"DateFW\", \"Fiscal Week Number\", \"Fiscal Week\", \"FWeeknYear\", \"Fiscal CurrYearOffset\", \"IsCurrentFQ\", \"IsCurrentFP\", \"IsCurrentFW\"}) else Table.RemoveColumns(ReorderCols,{\"Fiscal Period Number\", \"DateFW\", \"Fiscal Week Number\", \"ISO Quarter Number\"})\n  in\n      ListCols,\n      Documentation = [\n      Documentation.Name =  \" fxCalendar\", \n      Documentation.Description = \" Date table function to create an ISO-8601 calendar\", \n      Documentation.LongDescription = \" Date table function to create an ISO-8601 calendar\", \n      Documentation.Category = \" Table\", \n      Documentation.Version = \" 2.01: full code review\",\n      Documentation.Source = \" local\", \n      Documentation.Author = \" Melissa de Korte\", \n      Documentation.Examples = { [Description =  \" See: https://forum.enterprisedna.co/t/extended-date-table-power-query-m-function/6390\", \n        Code = \" Optional paramters: #(lf)\n        (FYStartMonthNum) Month number the fiscal year starts, Januari if omitted #(lf) \n        (Holidays) Select a query (and column) that contains a list of holiday dates #(lf) \n        (WDStartNum) Switch default weekday numbering from 0-6 to 1-7 by entering a 1 #(lf)\n        (AddRelativeNetWorkdays) if true adds a Relative Networkdays column to the date table #(lf)\n        #(lf)\n        Important to note: #(lf)\n        [Fiscal Week] starts on a Monday and can contain less than 7 days in a First- and/or Last Week of a FY #(lf)\n        [IsWeekDay] does not take holiday dates into account  #(lf)\n        [IsBusinessDay] does take optional holiday dates into account  #(lf)\n        [IsPYTD] and [IsPFYTD] compare Previous [Day of Year] with the Current [Day of Year] number, so dates don't align in leap years #(lf)\n        IMPORTANT! No Fiscal columns will be added if the (FYStartMonthNum) is omitted\", \n        Result = \" \" ] }\n      ]\n  in \n  Value.ReplaceType( fnDateTable, Value.ReplaceMetadata( Value.Type( fnDateTable ), Documentation ))\nin\n    Source"
                        }
                    ],
                    "configuredBy": "victorsam@vsamautomation.com",
                    "configuredById": "7afce4a6-37a7-4db8-962e-9b8d4e2bc885",
                    "isEffectiveIdentityRequired": false,
                    "isEffectiveIdentityRolesRequired": false,
                    "targetStorageMode": "Abf",
                    "createdDate": "2025-08-29T08:28:00.173",
                    "contentProviderType": "PbixInImportMode",
                    "datasourceUsages": [
                        {
                            "datasourceInstanceId": "03cbadfd-3beb-4cc9-99b6-c469e7d20d50"
                        }
                    ],
                    "tags": []
                },
                {
                    "id": "cc7bc30b-a5bb-4a17-bfa9-9675940f2468",
                    "name": "Report Usage Metrics Model",
                    "tables": [
                        {
                            "name": "Dates",
                            "isHidden": false,
                            "columns": [
                                {
                                    "name": "Date",
                                    "dataType": "DateTime",
                                    "isHidden": false,
                                    "columnType": "Data"
                                },
                                {
                                    "name": "Month",
                                    "dataType": "Int64",
                                    "isHidden": false,
                                    "columnType": "Data"
                                },
                                {
                                    "name": "Day",
                                    "dataType": "Int64",
                                    "isHidden": false,
                                    "columnType": "Data"
                                },
                                {
                                    "name": "OwnerTenantGuid",
                                    "dataType": "String",
                                    "isHidden": true,
                                    "columnType": "Data"
                                },
                                {
                                    "name": "OwnerUserGuid",
                                    "dataType": "String",
                                    "isHidden": true,
                                    "columnType": "Data"
                                },
                                {
                                    "name": "OwnerGroupGuid",
                                    "dataType": "String",
                                    "isHidden": true,
                                    "columnType": "Data"
                                }
                            ],
                            "measures": []
                        },
                        {
                            "name": "Reports",
                            "isHidden": false,
                            "columns": [
                                {
                                    "name": "OwnerTenantGuid",
                                    "dataType": "String",
                                    "isHidden": true,
                                    "columnType": "Data"
                                },
                                {
                                    "name": "OwnerUserGuid",
                                    "dataType": "String",
                                    "isHidden": true,
                                    "columnType": "Data"
                                },
                                {
                                    "name": "OwnerGroupGuid",
                                    "dataType": "String",
                                    "isHidden": true,
                                    "columnType": "Data"
                                },
                                {
                                    "name": "ReportGuid",
                                    "dataType": "String",
                                    "isHidden": false,
                                    "columnType": "Data"
                                },
                                {
                                    "name": "DisplayName",
                                    "dataType": "String",
                                    "isHidden": false,
                                    "columnType": "Data"
                                }
                            ],
                            "measures": []
                        },
                        {
                            "name": "ReportsCount",
                            "isHidden": false,
                            "columns": [
                                {
                                    "name": "TenantGuid",
                                    "dataType": "String",
                                    "isHidden": true,
                                    "columnType": "Data"
                                },
                                {
                                    "name": "Total",
                                    "dataType": "Int64",
                                    "isHidden": false,
                                    "columnType": "Data"
                                }
                            ],
                            "measures": []
                        },
                        {
                            "name": "Views",
                            "isHidden": false,
                            "columns": [
                                {
                                    "name": "Date",
                                    "dataType": "DateTime",
                                    "isHidden": false,
                                    "columnType": "Data"
                                },
                                {
                                    "name": "OwnerTenantGuid",
                                    "dataType": "String",
                                    "isHidden": true,
                                    "columnType": "Data"
                                },
                                {
                                    "name": "OwnerUserGuid",
                                    "dataType": "String",
                                    "isHidden": true,
                                    "columnType": "Data"
                                },
                                {
                                    "name": "OwnerGroupGuid",
                                    "dataType": "String",
                                    "isHidden": true,
                                    "columnType": "Data"
                                },
                                {
                                    "name": "ReportGuid",
                                    "dataType": "String",
                                    "isHidden": false,
                                    "columnType": "Data"
                                },
                                {
                                    "name": "Platform",
                                    "dataType": "String",
                                    "isHidden": false,
                                    "columnType": "Data"
                                },
                                {
                                    "name": "DistributionMethod",
                                    "dataType": "String",
                                    "isHidden": false,
                                    "columnType": "Data"
                                },
                                {
                                    "name": "UserGuid",
                                    "dataType": "String",
                                    "isHidden": true,
                                    "columnType": "Data"
                                },
                                {
                                    "name": "ReportPage",
                                    "dataType": "String",
                                    "isHidden": false,
                                    "columnType": "Data"
                                },
                                {
                                    "name": "GranularViewsCount",
                                    "dataType": "Int64",
                                    "isHidden": true,
                                    "columnType": "Data"
                                }
                            ],
                            "measures": [
                                {
                                    "name": "ViewersCount",
                                    "expression": "DISTINCTCOUNT([UserGuid])",
                                    "isHidden": false
                                },
                                {
                                    "name": "ViewsCount",
                                    "expression": "SUM([GranularViewsCount])",
                                    "isHidden": false
                                }
                            ]
                        },
                        {
                            "name": "ViewsRanking",
                            "isHidden": false,
                            "columns": [
                                {
                                    "name": "OwnerTenantGuid",
                                    "dataType": "String",
                                    "isHidden": true,
                                    "columnType": "Data"
                                },
                                {
                                    "name": "OwnerUserGuid",
                                    "dataType": "String",
                                    "isHidden": true,
                                    "columnType": "Data"
                                },
                                {
                                    "name": "OwnerGroupGuid",
                                    "dataType": "String",
                                    "isHidden": true,
                                    "columnType": "Data"
                                },
                                {
                                    "name": "ReportGuid",
                                    "dataType": "String",
                                    "isHidden": false,
                                    "columnType": "Data"
                                },
                                {
                                    "name": "ViewsRank",
                                    "dataType": "Int64",
                                    "isHidden": false,
                                    "columnType": "Data"
                                }
                            ],
                            "measures": []
                        },
                        {
                            "name": "ViewersRanking",
                            "isHidden": false,
                            "columns": [
                                {
                                    "name": "OwnerTenantGuid",
                                    "dataType": "String",
                                    "isHidden": true,
                                    "columnType": "Data"
                                },
                                {
                                    "name": "OwnerUserGuid",
                                    "dataType": "String",
                                    "isHidden": true,
                                    "columnType": "Data"
                                },
                                {
                                    "name": "OwnerGroupGuid",
                                    "dataType": "String",
                                    "isHidden": true,
                                    "columnType": "Data"
                                },
                                {
                                    "name": "ReportGuid",
                                    "dataType": "String",
                                    "isHidden": false,
                                    "columnType": "Data"
                                },
                                {
                                    "name": "ViewersRank",
                                    "dataType": "Int64",
                                    "isHidden": false,
                                    "columnType": "Data"
                                }
                            ],
                            "measures": []
                        },
                        {
                            "name": "Platforms",
                            "isHidden": false,
                            "columns": [
                                {
                                    "name": "Name",
                                    "dataType": "String",
                                    "isHidden": false,
                                    "columnType": "Data"
                                }
                            ],
                            "measures": []
                        },
                        {
                            "name": "DistributionMethods",
                            "isHidden": false,
                            "columns": [
                                {
                                    "name": "OwnerTenantGuid",
                                    "dataType": "String",
                                    "isHidden": true,
                                    "columnType": "Data"
                                },
                                {
                                    "name": "OwnerUserGuid",
                                    "dataType": "String",
                                    "isHidden": true,
                                    "columnType": "Data"
                                },
                                {
                                    "name": "OwnerGroupGuid",
                                    "dataType": "String",
                                    "isHidden": true,
                                    "columnType": "Data"
                                },
                                {
                                    "name": "Name",
                                    "dataType": "String",
                                    "isHidden": false,
                                    "columnType": "Data"
                                }
                            ],
                            "measures": []
                        },
                        {
                            "name": "Users",
                            "isHidden": false,
                            "columns": [
                                {
                                    "name": "OwnerTenantGuid",
                                    "dataType": "String",
                                    "isHidden": true,
                                    "columnType": "Data"
                                },
                                {
                                    "name": "UserGuid",
                                    "dataType": "String",
                                    "isHidden": false,
                                    "columnType": "Data"
                                },
                                {
                                    "name": "GivenName",
                                    "dataType": "String",
                                    "isHidden": false,
                                    "columnType": "Data"
                                },
                                {
                                    "name": "FamilyName",
                                    "dataType": "String",
                                    "isHidden": false,
                                    "columnType": "Data"
                                },
                                {
                                    "name": "UserPrincipalName",
                                    "dataType": "String",
                                    "isHidden": false,
                                    "columnType": "Data"
                                }
                            ],
                            "measures": []
                        }
                    ],
                    "configuredBy": "victorsam@vsamautomation.com",
                    "configuredById": "7afce4a6-37a7-4db8-962e-9b8d4e2bc885",
                    "isEffectiveIdentityRequired": false,
                    "isEffectiveIdentityRolesRequired": false,
                    "directQueryRefreshSchedule": {
                        "frequency": 120,
                        "days": [],
                        "times": [],
                        "localTimeZoneId": "UTC"
                    },
                    "targetStorageMode": "Abf",
                    "createdDate": "2025-10-06T11:33:03.193",
                    "contentProviderType": "UsageMetricsUserReport",
                    "schemaRetrievalError": "Model mashup is not available, as it's not supported by the Analysis Services engine",
                    "tags": []
                }
            ],
            "dataflows": [],
            "datamarts": []
        }
    ],
    "datasourceInstances": [
        {
            "datasourceType": "MySql",
            "connectionDetails": {
                "server": "vsamautomation.com",
                "database": "vsamaut1_waziri"
            },
            "datasourceId": "03cbadfd-3beb-4cc9-99b6-c469e7d20d50",
            "gatewayId": "ac01df63-0d47-4271-addb-28319dcee781"
        }
    ]
}